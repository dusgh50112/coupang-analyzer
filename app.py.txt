import pandas as pd

# ===============================
# 설정
# ===============================
INPUT_FILE = "coupang_orders.xlsx"
ORDER_OUTPUT = "정리된_주문.xlsx"
SUMMARY_OUTPUT = "상품별_판매량.xlsx"

# ===============================
# 엑셀 불러오기
# ===============================
df = pd.read_excel(INPUT_FILE)

# 필요한 컬럼만 추출 (쿠팡 기본 컬럼 기준)
df = df[[
    "주문번호",
    "상품명",
    "판매수량",
    "판매가"
]]

# ===============================
# 총 매출 계산
# ===============================
df["매출"] = df["판매수량"] * df["판매가"]
total_sales = df["매출"].sum()

# ===============================
# 상품별 판매량 집계
# ===============================
summary = df.groupby("상품명").agg(
    총판매수량=("판매수량", "sum"),
    총매출=("매출", "sum")
).reset_index()

# ===============================
# 엑셀 저장
# ===============================
df.to_excel(ORDER_OUTPUT, index=False)
summary.to_excel(SUMMARY_OUTPUT, index=False)

# ===============================
# 결과 출력
# ====
